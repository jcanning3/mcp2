<p id="notice"><%= notice %></p>


<h2> <%= @event.name %> </h1>

<br>

<p>
  <strong>Start:</strong>
  <%= @event.start.strftime("%a %b %e %I:%M%p %Z") %>
</p>

<p>
  <strong>End:</strong>
  <%= @event.try(:end).try(:strftime, '%a %b %e %I:%M%p %Z') %>
</p>

<p>
  <strong>Type:</strong>
  <%= @event.type.name %>
</p>


<p>
  <strong>Location:</strong>
  <%= @event.location.name %>
</p>

<p>
  <strong>Notes:</strong>
  <%= @event.notes %>
</p>

<br> <br> <br>

  <h4>Tasks:</h4>
    <table class='table table-hover'>
      <tbody>
	<% @event.tasks.each do |t| %>
	  <% ins = @event.instructions.where(task_id: t.id, event_id: @event.id).first %>
          <tr>
	    <td> <%= t.name =%> </td>
	    <td> <%= ins.name if ins %> </td>
          </tr>
        <% end %>
      </tbody>
    </table>

<br> <br> <br>

<h4>Concerts</h4>

<br> 

  <% concerts = @event.teams.first.events.where(type_id: 6) %>
  <% if concerts %>
    <ul>
    <% @event.teams.first.events.where(type_id: 6).each do |ee| %>
      <li>
      <%= ee.try(:start).try(:strftime, '%A %B %e %I:%M%p') %> â€¢
      <%= ee.name %> <br>
      </li>
    <% end %>
    </ul>
  <% end %>

<br> <br> 

<h4>Teams</h4>
<table>
  <tbody>
    <% @event.teams.each do |t| %>
      <tr>
        <td><%= t.nickname %> </td>
      </tr>

      <% t.musicians.includes(:instrument).order('instruments.order').each do |m| %>
        <tr>
          <td> </td>
          <td> <%= m.name if m %> </td>
          <td> <%= m.instrument.name if m.instrument %> </td>
        </tr>
      <% end %>

    <% end %>
  </tbody>
</table>

<br> <br> <br>

<h4>Notes</h4>
<table class='table table-hover'>
  <tbody>
    <% @bits = @event.sheets %>
    <% @bits.each do |s| %>
      <tr>
        <td><%= s.created_at.strftime("%m/%d/%y %I:%M%p") %></td>
        <td><%= s.note %></td>
      </tr>
    <% end %>
  </tbody>
</table>


<%= link_to 'Edit', edit_event_path(@event), class: 'btn btn-warning btn-sm' %> |
<%= link_to 'Back', events_path, class: 'btn btn-warning btn-sm' %>
